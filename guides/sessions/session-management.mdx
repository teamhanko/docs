---
sidebarTitle: Sessions
title: Sessions
description: Learn how to manage user sessions.
---

## Sessions and JSON Web Tokens

A session is created when a user authenticates with Hanko (either by registering a new account or by signing in to
an account). The session is represented by a JSON Web Token ([JWT](https://datatracker.ietf.org/doc/html/rfc7519)).
JWTs encode claims about subjects (users) as JSON objects. They can also include a signature, in which case their
structure is that of a JSON Web Signature ([JWS](https://datatracker.ietf.org/doc/html/rfc7515)). All JWTs issued by
Hanko are signed JWSs.

API operations that establish a session (login, registration) return a session token in an `X-Auth-Token`
header.

<Note>
    When using [Hanko Elements](https://docs.hanko.io/guides/hanko-elements/introduction) or
    the [Hanko Frontend SDK](https://docs.hanko.io/resources/sdks#sdks), the session token is read from the
    `X-Auth-Token` header and used to set a cookie (name: `hanko`) on the client-side. If you use neither Hanko
    Elements nor the SDK, you have to take care of storing the session token yourself.
</Note>

Subsequent requests to protected API endpoints must then provide the session token in a `Cookie` request header
or alternatively in an `Authorization` header with the `Bearer` scheme (i.e. `Authorization: Bearer <JWT>`).

Upon session creation, a unique identifier is generated and stored in the database, linked to the corresponding user.
This identifier is also included in the session JWT under the session_id claim. For subsequent requests, the Hanko API
validates the JWT signature and uses the session_id to query the database for an active session match. This enables
remote session revocation. As a result, if a user is logged in on one device but has multiple active sessions across
other devices, the API’s [Profile](https://docs.hanko.io/api-reference/flow/profile) flow facilitates the listing and
explicit termination of sessions on those devices. This functionality is also accessible through the UI via the Hanko
Elements’ [Profile Component](https://docs.hanko.io/guides/hanko-elements/profile-component).

## Session validation

To manually validate a session you can use the API's  `sessions/validate` [endpoint](https://docs.hanko.io/api-reference/public/session-management/validate-a-session-1). You need to provide the
session token in the request body. The endpoint validates the token's
expiry and signature and ensures that the encoded `session_id` matches a persisted session.

The session endpoint returns an object that contains information about the validity of a session, the
session token's expiry as well as claims about the user the session is associated with.

## Session termination

Depending on your tenant's configuration, there are various methods available for explicitly or implicitly terminating
a session.

### Explicit user logout

A user can explicitly request a logout. This requires a request to the `/users/logout`
[endpoint](https://docs.hanko.io/api-reference/public/user-management/log-out-the-current-user).
A successful request clears session cookies and terminates the session associated with the session token.

### Limiting session duration

Sessions can be terminated (or: become invalid) by exceeding an expiry. This expiry can be configured by setting the
session duration. The session duration determines how long a user remains logged in after authenticating.
By default, the session duration is set to 12 hours in the Hanko Cloud Console.
You can change this to a value between 1 minute and 1 month to suit your application's needs.

To change the session duration, follow these steps:

1. Log in to [Hanko Cloud](https://cloud.hanko.io) and select your project.
2. Navigate to `Settings > Session`.
3. Under `Session duration`, set the desired session duration and click `Save`.

### Limiting concurrent session

Sessions can also be (implicitly) terminated by exceeding the number of allowed active sessions. By default,
Hanko allows 5 concurrent sessions. If a user establishes another session, then the oldest session becomes
invalid.

To configure the allowed amount of concurrent sessions:

1. Log in to [Hanko Cloud](https://cloud.hanko.io) and select your project.
2. Navigate to `Settings > Session`.
3. Under `Session limit`, enter the desired amount and click `Save`.


## Session JWT structure

The session JWT is a [compact](https://datatracker.ietf.org/doc/html/rfc7515#section-3.1) JWS. It is a string composed
of three base64 URL safe encoded parts ([header](#jwt-header), [payload](#jwt-payload) and signature), separated by a
dot (`.`). The JWT payload contains the claims about a user.

### JWT Header

```json
{
  "alg": "RS256",
  "kid": "2288bfa9-3214-4f19-9757-92631190420b",
  "typ": "JWT"
}
```

<ResponseField name="alg" type="string">
    The algorithm used for signing this token.
</ResponseField>

<ResponseField name="kid" type="string">
    The key ID indicating which key was used to secure the token.
</ResponseField>

<ResponseField name="typ" type="string">
    The media type of this token.
</ResponseField>


### JWT Payload

```json
{
  "aud": [ "example.com" ],
  "email": {
    "address": "user@example.com",
    "is_primary": true,
    "is_verified": true
  },
  "exp": 17123108000,
  "iat": 1712307200,
  "session_id": "140f3967-ab87-4caa-80bd-603ac59c545f",
  "sub": "9930ac89-1584-488c-bd63-1607f03ab1e8",
  "username": "johndoe"
}
```

<ResponseField name="aud" type="string[]">
    The audience for which the JWT was created. It specifies the intended recipient or system that should accept this
    JWT. When using Hanko Cloud, the `aud` will be your `App URL`.
</ResponseField>

<ResponseField name="email" type="object">
    An object containing information about the user’s email address.
    <Expandable title="properties">
        <ResponseField name="address" type="string">
            The current primary email address of the user.
        </ResponseField>
        <ResponseField name="is_primary" type="boolean">
            A boolean field indicating whether the email address is the primary email. Currently, this field is
            redundant because only the primary email is included in the JWT.
        </ResponseField>
        <ResponseField name="is_verified" type="boolean">
            A boolean field indicating whether the email address has been verified.
        </ResponseField>
    </Expandable>
</ResponseField>

<ResponseField name="exp" type="integer">
    The (UNIX) timestamp indicating when the JWT will expire.
</ResponseField>

<ResponseField name="iat" type="integer">
    The (UNIX) timestamp indicating when the JWT was created.
</ResponseField>

<ResponseField name="session_id" type="string">
    The ID of the session.
</ResponseField>

<ResponseField name="sub" type="integer">
    The ID of the user.
</ResponseField>

<ResponseField name="username" type="string">
    The username of the user (if set).
</ResponseField>

