---
sidebarTitle: "Bun"
title: Integrate Hanko with Bun backend
---

## Add the Hanko API URL

Retrieve the API URL from the [Hanko console](https://cloud.hanko.io/) and place it in your .env file.

```sh .env
HANKO_API_URL=https://f4****-4802-49ad-8e0b-3d3****ab32.hanko.io
```

<Note>If you are self-hosting Hanko you need to provide your own URL.</Note>


## Hanko Authentication with session token

Upon a succesful login, Hanko sends a cookie containing a session token. You can use this session token to authenticate requests on your backend.

### Steps to Authenticate Requests

1. **Retrieve the Session Token.**

2. **Verify the Session token using the Hanko [Validate](/api-reference/public/session-management/validate-a-session-1) API endpoint.**

### Bun-based Backend Examples

In the following examples, we demonstrate how to implement a custom middleware in [Hono.js](https://hono.dev/) and [Elysia.js](https://elysiajs.com/) backend.

<Tabs>
<Tab title="Hono.js">
```bash install commands
bun init hono-backend
bun add hono
```
```js index.ts
import { Hono, type Context } from 'hono'
import { getCookie } from 'hono/cookie'
import { cors } from 'hono/cors'

const app = new Hono()

const hankoApiUrl = process.env.HANKO_API_URL

app.use(
    "/*",
    cors({
      origin: "http://localhost:5173", // your frontend URL
      credentials: true,
    })
  );

async function verifyTokenMiddleware(c: Context, next: Function) {
    let token: any = null

    const authHeader = c.req.header('authorization')
    if (authHeader && authHeader.startsWith('Bearer ')) {
      token = authHeader.split(' ')[1]
    } else {
      token = getCookie(c, 'hanko')
    }
  
    if (!token || token.length === 0) {
      console.log('Could not find a token to validate')
      return c.text('Unauthorized', 401)
    }
  
    let authError = false
  
    try {
      const validationOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ session_token: token }),
      }
  
      // Use the hanko /sessions/validate api endpoint 
      const validationResponse = await fetch(
        `${hankoApiUrl}/sessions/validate`,
        validationOptions
      )
  
      if (!validationResponse.ok) {
        authError = true
      } else {
        const validationData : any = await validationResponse.json()
        if (!validationData.is_valid) {
          authError = true
        }
      }
    } catch (error) {
      console.error('Error validating token:', error)
      authError = true
    }
  
    if (authError) {
      console.log('Your token was not valid')
      return c.text('Unauthorized', 401)
    }
  
    console.log('Token validated')
    await next()
}


app.get("/validate", verifyTokenMiddleware, (c) =>
    c.json({ message: "Hello from protected route!" })
);


export default {
  port: 5001,
  fetch: app.fetch,
}

```
```bash run command
bun index.ts
```

## Try it yourself

<Card
  title="Hono.js example (React frontend)"
  href="https://github.com/teamhanko/hanko-hono-react-starter"
  icon={
    <svg
      xmlns="http://www.w3.org/2000/svg"
      className="icon icon-tabler icon-tabler-external-link"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      strokeWidth="2"
      stroke="currentColor"
      fill="none"
      strokeLinecap="round"
      strokeLinejoin="round"
    >
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6"></path>
      <path d="M11 13l9 -9"></path>
      <path d="M15 4h5v5"></path>
    </svg>
  }
>
  Full source code available on our GitHub.
</Card>
</Tab>
<Tab title="Elysia.js">
```bash install commands
bun init
bun add elysia
bun add @elysiajs/cors
```
```ts index.ts
import { Elysia } from 'elysia'
import { cors } from '@elysiajs/cors'

const app = new Elysia()

const hankoApiUrl = process.env.HANKO_API_URL

app.use(cors({
  origin: 'http://localhost:5173', // Your frontend URL
  credentials: true
}))

const validateToken = async (token: string) => {
    if (!token || token.length === 0) return false

    try {
      const validationOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ session_token: token }),
      }
      // Use the hanko /sessions/validate api endpoint 
      const validationResponse = await fetch(
        `${hankoApiUrl}/sessions/validate`,
        validationOptions
      )
  
      if (!validationResponse.ok) return false
  
      const validationData: any = await validationResponse.json()
      return validationData.is_valid === true
    } catch (error) {
      console.error('Error validating token:', error)
      return false
    }
};

app.get("/validate", () => "Validation Succesfull!", {
    beforeHandle: async ({ set, cookie: { hanko } }) => {
        const token = hanko?.value || ""
      
        if (!token || !(await validateToken(token))) {
          set.status = 401
          return 'Unauthorized'
        }
      }
  });
  

app.listen(5001)
console.log('Server is now running...');
```
```bash run command
bun run index.ts
```
## Try it yourself

<Card
  title="Elysia.js example (React frontend)"
  href="https://github.com/teamhanko/hanko-elysia-react-starter"
  icon={
    <svg
      xmlns="http://www.w3.org/2000/svg"
      className="icon icon-tabler icon-tabler-external-link"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      strokeWidth="2"
      stroke="#5465FF"
      fill="none"
      strokeLinecap="round"
      strokeLinejoin="round"
    >
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6"></path>
      <path d="M11 13l9 -9"></path>
      <path d="M15 4h5v5"></path>
    </svg>
  }
>
  Full source code available on our GitHub.
</Card>
</Tab>
</Tabs>


## Frontend request example
```tsx example.ts
fetch('http://localhost:5001/validate', {
    credentials: 'include', // This is required to include the cookie in the request
}).then((res) => {
    console.log(res.ok);
}).catch(() => {
    console.log(False);
});
```